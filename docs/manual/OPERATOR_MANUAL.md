# お絵描きバトラー 運営マニュアル

**対象:** イベント現場でアプリを操作する担当者向け

**バージョン:** 1.0.0
**最終更新:** 2025-10-08

---

## 📋 目次

1. [運営担当者の役割](#運営担当者の役割)
2. [起動前の準備](#起動前の準備)
3. [アプリの起動と終了](#アプリの起動と終了)
4. [キャラクター登録作業](#キャラクター登録作業)
5. [バトル運営](#バトル運営)
6. [トラブル対応](#トラブル対応)
7. [1日の流れ（例）](#1日の流れ例)

---

## 運営担当者の役割

### あなたの役割

参加者が描いたキャラクターをシステムに登録し、バトルを実行する「オペレーター」です。

### 主な作業

✅ **キャラクター登録**
- 参加者から受け取った画像をアプリに登録
- AI分析でステータス生成
- 登録内容の確認

✅ **バトル実行**
- バトルモードの選択と実行
- 画面投影での演出
- 結果の確認と共有

✅ **トラブル対応**
- エラー発生時の対処
- データ確認と修正
- システム再起動

---

## 起動前の準備

### 1. 環境チェックリスト

起動前に以下を確認してください:

#### ハードウェア
- [ ] PCの電源が入る
- [ ] プロジェクター/モニターが接続されている
- [ ] インターネット接続がある（オンラインモードの場合）

#### ソフトウェア
- [ ] Pythonがインストールされている（バージョン3.11以上）
- [ ] 仮想環境 `.venv` が存在する
- [ ] 必要な画像が準備されている

#### データ
- [ ] `.env` ファイルが設定されている
- [ ] Google Sheets接続が確認済み（オンラインモードの場合）

### 2. モード確認

**オンラインモード（推奨）**
- インターネット接続必須
- Google Sheetsにデータ保存
- バトル履歴とランキングが記録される

**オフラインモード（バックアップ）**
- インターネット不要
- ローカルDBに保存
- 基本機能のみ利用可能

---

## アプリの起動と終了

### 起動手順

#### Windows

```cmd
REM 1. ターミナルを開く（コマンドプロンプトまたはPowerShell）

REM 2. プロジェクトフォルダに移動
cd C:\path\to\OekakiBattler

REM 3. 仮想環境を有効化
.venv\Scripts\activate

REM 4. アプリ起動
python main.py
```

#### Mac/Linux

```bash
# 1. ターミナルを開く

# 2. プロジェクトフォルダに移動
cd /path/to/OekakiBattler

# 3. 仮想環境を有効化
source .venv/bin/activate

# 4. アプリ起動
python main.py
```

### 起動確認

✅ メインウィンドウが表示される
✅ ステータスバーに「オンラインモード」または「オフラインモード」と表示
✅ キャラクター一覧が読み込まれる

### 終了手順

1. メインウィンドウの「×」ボタンをクリック
2. 「終了しますか？」で「はい」を選択
3. ウィンドウが閉じたら完了

⚠️ **注意:** バトル実行中は終了しないでください

---

## キャラクター登録作業

### 基本フロー

```
参加者が絵を描く
    ↓
写真を撮影（スマホ/カメラ）
    ↓
画像ファイルを受け取る
    ↓
アプリに登録
    ↓
ステータス確認
    ↓
登録完了
```

### 詳細手順

#### 1. 画像ファイルの受け取り

参加者から画像を受け取る方法:

**方法A: LINE Botで受け取る（推奨）**
- 参加者がLINE Botに画像送信
- 自動でGoogle Driveにアップロード
- アプリから直接取得可能

**方法B: 直接ファイルを受け取る**
- USBメモリ、AirDrop、メール等
- PCの決まったフォルダに保存
- 例: `C:\OekakiBattler\受付画像\`

**画像の要件:**
- 形式: PNG, JPG, JPEG
- サイズ: 10MB以下推奨
- 内容: キャラクターが明確に写っている

#### 2. アプリでの登録操作

##### ステップ1: 新規登録画面を開く

1. メインウィンドウで「新規キャラクター登録」ボタンをクリック
2. 登録ウィンドウが開く

##### ステップ2: 画像を選択

1. 「画像を選択」ボタンをクリック
2. ファイル選択ダイアログで画像を選ぶ
3. プレビューが表示されることを確認

##### ステップ3: AI分析を実行

1. 「AIでステータス生成」ボタンをクリック
2. **5〜15秒待つ**（分析中）
3. 自動で以下が生成される:
   - キャラクター名
   - HP、攻撃、防御、素早さ、魔力、運
   - 説明文

💡 **Tips:** 分析中は他の操作をしないでください

##### ステップ4: 内容確認

生成された内容を確認:

- [ ] キャラクター名が適切
- [ ] ステータス値が妥当（各項目10〜200程度）
- [ ] 説明文が適切

⚠️ **不適切な内容の場合:**
- 「キャンセル」→ 画像を変えて再登録
- または手動でテキストを修正

##### ステップ5: 登録実行

1. 内容確認後「登録」ボタンをクリック
2. 「登録しますか？」で「はい」を選択
3. 数秒後、メイン画面のキャラクター一覧に追加される

✅ **登録完了の確認:**
- 一覧にキャラクター名が表示
- 勝敗数が「勝:0 負:0」になっている
- 画像サムネイルが表示されている

### 登録時のトラブル対応

| 問題 | 原因 | 対処法 |
|------|------|--------|
| AI分析が終わらない | ネットワークエラー | 10秒待ってキャンセル→再実行 |
| 画像が表示されない | ファイル形式エラー | PNG/JPGに変換して再登録 |
| ステータスがおかしい | 画像認識ミス | 手動で数値を修正 |
| 同じ名前が登録済み | 重複エラー | 名前を変更（例: 「キャラA_2」） |

---

## バトル運営

### バトルモード一覧

#### 1. 1vs1 バトル（個別対戦）

**用途:** 特定のキャラクター同士を戦わせたい時

**操作手順:**
1. 「バトル」ボタンをクリック
2. バトル選択画面で「1vs1バトル」を選択
3. キャラクター1を選択
4. キャラクター2を選択
5. 「バトル開始」ボタンをクリック
6. 全画面でバトル開始

#### 2. ランダムバトル

**用途:** 登録キャラクターからランダムに対戦

**操作手順:**
1. 「バトル」ボタンをクリック
2. 「ランダムバトル」を選択
3. 自動で2体選択される
4. 「バトル開始」ボタンをクリック

#### 3. エンドレスバトル（トーナメント）

**用途:** 全キャラクターで勝ち抜き戦

**操作手順:**
1. メニューバー → ゲーム → エンドレスバトル
2. 説明を確認して「バトル開始」
3. 自動で全バトルが実行される
4. 最後まで勝ち残ったキャラが優勝

⏱️ **所要時間:** キャラクター数 × 約30秒

#### 4. ストーリーモード

**用途:** 特定キャラクターでボス戦に挑戦

**操作手順:**
1. メニューバー → ゲーム → ストーリーモード
2. 挑戦するキャラクターを選択
3. 「バトル開始」をクリック
4. Lv1→Lv5まで自動で連戦
5. クリアまたはゲームオーバー

### バトル中の操作

#### 画面の見方

```
┌─────────────────────────────────────────┐
│  キャラA              VS        キャラB │
│  HP: ████████░░ 80/100   HP: ████░░░░ 40/100 │
│                                         │
│  [キャラA] の攻撃！                      │
│  キャラBに15ダメージ！                   │
│                                         │
│  ターン: 5 / 30                         │
└─────────────────────────────────────────┘
```

#### バトル中にできること

- **ESCキー**: バトルを中断して戻る
- **観戦のみ**: 操作は不要、自動で進行

#### バトル終了後

1. **結果画面が表示**（勝者、ターン数、ダメージ等）
   - 表示時間: **10秒間**（自動的に閉じる）
   - カウントダウン表示あり
2. **手動で閉じる**（待たずに次へ進む場合）
   - クリック: 画面上の任意の場所
   - スペースキー/ESCキー
   - OKボタン
3. 勝敗記録が自動保存
4. 元の画面に戻る

### バトル演出のポイント

🎬 **観客を盛り上げる:**
- バトル開始前に「次はこのキャラクター同士です！」と紹介
- プロジェクターで大画面表示
- ターン数が進むと盛り上がる
- クリティカル・ガードブレイクの演出に注目

---

## トラブル対応

### よくあるトラブルと対処法

#### 1. アプリが起動しない

**チェック項目:**
- [ ] 仮想環境が有効化されているか確認
- [ ] `python main.py` のコマンドが正しいか確認
- [ ] エラーメッセージを確認

**対処法:**
```bash
# 仮想環境を有効化し直す
source .venv/bin/activate  # Mac/Linux
.venv\Scripts\activate     # Windows

# 再起動
python main.py
```

#### 2. オンラインモードに接続できない

**症状:**
- ステータスバーに「オフラインモード」と表示
- Google Sheetsにデータが保存されない

**対処法:**
1. インターネット接続を確認
2. `.env` ファイルの `SPREADSHEET_ID` を確認
3. Google Sheetsの共有設定を確認
4. アプリを再起動

⚠️ **緊急時:** オフラインモードでも基本機能は動作します

#### 3. キャラクター画像が表示されない

**対処法:**
1. 画像ファイルが存在するか確認
2. ファイル形式がPNG/JPGか確認
3. ファイルサイズが大きすぎないか確認（10MB以下）
4. 画像を再アップロード

#### 4. バトルが開始できない

**チェック項目:**
- [ ] キャラクターが2体以上登録されているか
- [ ] 選択したキャラクターが存在するか
- [ ] 前回のバトルが完全に終了しているか

**対処法:**
- アプリを再起動
- キャラクター一覧を再読み込み

#### 5. AI分析が失敗する

**原因:**
- ネットワークエラー
- API制限
- 画像認識エラー

**対処法:**
1. 10秒待ってから再実行
2. 別の画像で試す
3. 手動でステータスを入力（非推奨）

### エラーメッセージ対応表

| エラーメッセージ | 意味 | 対処法 |
|-----------------|------|--------|
| "Google Sheets接続エラー" | オンラインモード失敗 | ネット接続確認、オフラインモードで継続 |
| "画像読み込みエラー" | ファイル形式エラー | PNG/JPG形式に変換 |
| "AI分析タイムアウト" | ネットワーク遅延 | 再実行、別画像で試す |
| "キャラクターが見つかりません" | データ不整合 | アプリ再起動、再登録 |
| "重複した名前です" | 同名キャラ存在 | 名前を変更 |

### 緊急時の対応

#### システムがフリーズした場合

1. **強制終了**
   - Windows: `Ctrl + Alt + Delete` → タスクマネージャー → Pythonプロセスを終了
   - Mac: `Cmd + Option + Esc` → 強制終了
   - Linux: ターミナルで `Ctrl + C`

2. **再起動**
   ```bash
   python main.py
   ```

3. **データ確認**
   - キャラクター一覧が正常に表示されるか確認
   - 最後の操作が保存されているか確認

#### データが消えた場合

**オンラインモード:**
- Google Sheetsを確認
- ブラウザから手動でデータ確認
- 必要に応じてバックアップから復元

**オフラインモード:**
- `data/database.db` が存在するか確認
- バックアップファイルから復元

---

## 1日の流れ（例）

### イベント開始前（30分前）

**準備作業**

- [ ] PCの電源を入れる
- [ ] プロジェクター/モニターを接続
- [ ] インターネット接続を確認
- [ ] アプリを起動
- [ ] オンラインモードを確認
- [ ] テストキャラクターでバトル動作確認

**動作確認項目:**
- 画像登録ができるか
- AI分析が動作するか
- バトルが実行できるか
- 画面投影が正常か

### イベント中

#### 受付・登録フェーズ（例: 13:00-14:00）

```
参加者到着
  ↓
絵を描いてもらう
  ↓
写真撮影
  ↓
画像受け取り
  ↓
アプリに登録（1人あたり2-3分）
  ↓
次の参加者
```

**ポイント:**
- 登録は順番に1人ずつ
- 画像の品質を事前チェック
- 不適切な画像は撮り直し依頼

#### バトルフェーズ（例: 14:00-15:00）

```
全員の登録完了
  ↓
バトルモード選択
  ↓
バトル実行（大画面投影）
  ↓
結果発表
  ↓
次のバトル
```

**進行例:**

1. **ランダムバトル × 5回** - ウォーミングアップ
2. **1vs1リクエストバトル** - 参加者のリクエストに応じる
3. **エンドレスバトル** - トーナメントで優勝者を決定
4. **結果発表** - ランキング表示

### イベント終了後

**片付け作業**

- [ ] 最終ランキングをスクリーンショット
- [ ] Google Sheetsでデータ確認（オンラインモードの場合）
- [ ] アプリを正常終了
- [ ] 画像ファイルをバックアップ
- [ ] 機材の片付け

**データ保管:**
- オンライン: Google Sheetsに自動保存済み
- オフライン: `data/database.db` をバックアップ
- 画像: `data/characters/` をバックアップ

---

## 付録

### 推奨タイムスケジュール

| 時間 | 作業 | 所要時間 |
|------|------|----------|
| 12:30-13:00 | 準備・動作確認 | 30分 |
| 13:00-14:00 | キャラクター登録 | 60分 (1人2-3分 × 20-30人) |
| 14:00-14:15 | バトル準備・説明 | 15分 |
| 14:15-15:00 | バトル実行 | 45分 |
| 15:00-15:15 | 結果発表 | 15分 |
| 15:15-15:30 | 片付け | 15分 |

### チェックリスト（印刷用）

**事前準備**
- [ ] PCセットアップ完了
- [ ] プロジェクター接続確認
- [ ] ネット接続確認
- [ ] アプリ起動確認
- [ ] テストバトル実行

**イベント中**
- [ ] 参加者人数カウント
- [ ] 全員の登録完了
- [ ] バトルモード選択
- [ ] 結果記録

**終了後**
- [ ] データバックアップ
- [ ] 機材片付け
- [ ] 報告書作成（任意）

### 連絡先

**技術サポート:**
- 開発者: [連絡先を記入]
- 緊急連絡: [電話番号を記入]

**マニュアル:**
- 本マニュアル: `docs/manual/OPERATOR_MANUAL.md`
- トラブルシューティング: `docs/manual/08_TROUBLESHOOTING.md`
- 技術マニュアル: `docs/manual/COMPLETE_MANUAL.md`

---

**お疲れ様でした！**

このマニュアルを使って、スムーズなイベント運営を実現してください。

ご不明点があれば、開発チームまでお問い合わせください。
